<meta http-equiv="origin-trial" content="Agx76XA0ITxMPF0Z8rbbcMllwuxsyp9qdtQaXlLqu1JUrdHB6FPonuyIKJ3CsBREUkeioJck4nn3KO0c0kkwqAMAAABJeyJvcmlnaW4iOiJodHRwOi8vbG9jYWxob3N0Ojg4ODgiLCJmZWF0dXJlIjoiV2ViR1BVIiwiZXhwaXJ5IjoxNjkxNzExOTk5fQ==">

<script src="dist/tvmjs_runtime.wasi.js"></script>
<script src="dist/tvmjs.bundle.js"></script>

<script>
  tvmjsGlobalEnv = tvmjsGlobalEnv || {};
</script>

<script type="module">
  import init, { TokenizerWasm } from "./dist/tokenizers-wasm/tokenizers_wasm.js";

  var initialized = false;
  async function getTokenizer(name) {
    if (!initialized) {
      await init();
    }
    const jsonText = await (await fetch("https://huggingface.co/" + name + "/raw/main/tokenizer.json")).text();
    return new TokenizerWasm(jsonText);
  }

  tvmjsGlobalEnv.getTokenizer = getTokenizer;
</script>

<script src="stable_diffusion.js"></script>

<h2> Web Stable Diffusion </h2>

<div>
  Input Prompt <input
  name="inputPrompt"
  id="inputPrompt"
  type="text"
  value="A photo of an astronaut riding a horse on mars"
  size="77"
/>
</div>
<div>
  Render intermediate steps (can show down execution) -
  <select name="vae-cycle" id="vaeCycle">
    <option value="-1">no</option>
    <option value="2">run vae every two unet steps after step 10</option>
  </select>
</br>
<button onclick="tvmjsGlobalEnv.asyncOnGenerate()">Generate</button>
</div>
<div>
<canvas id="canvas" width="512" height="512"></canvas>
</div>
